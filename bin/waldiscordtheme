#!/bin/bash

# Get color0 (background) and color7 (accent) from xrdb
background=$(xrdb -query | grep "*\.color0" | awk '{print $2}' | sed 's/#//g')
accent=$(xrdb -query | grep "*\.color2" | awk '{print $2}' | sed 's/#//g')
alpha=$(xrdb -query | grep "st\.alpha" | awk '{print $2}' | sed 's/#//g')

# Convert hex codes to rgb values
background=$(printf "%d, %d, %d\n" 0x${background:0:2} 0x${background:2:2} 0x${background:4:2})
accent=$(printf "%d, %d, %d\n" 0x${accent:0:2} 0x${accent:2:2} 0x${accent:4:2})

# Theme file to be overwritten (needs to already have //META)
themepath="/home/stefan/.config/BetterDiscord/themes/WalColorScheme.theme.css"

# Get META before overwriting the file
meta=$(cat $themepath | grep "META")

# Write the new color scheme to the theme file
echo -e "$meta\n\n:root {\n  --background-color: $background !important;\n  --accent-color: $accent !important;\n  --background-alpha: $alpha !important;\n}" > $themepath

